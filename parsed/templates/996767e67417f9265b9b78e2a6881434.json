{"layout/empty":"<!DOCTYPE html>\r\n<html lang=\"{{ locale_name }}\">\r\n<head>\r\n    <title>{{ head.title }}</title>\r\n    {{{ head.meta_tags }}}\r\n    {{{ head.config }}}\r\n    <link href=\"{{ head.favicon }}\" rel=\"shortcut icon\">\r\n    {{#block \"head\"}}{{/block}}\r\n    {{inject 'themeSettings' theme_settings}}\r\n    {{~inject 'template' template}}\r\n    {{~inject 'pageType' page_type}}\r\n    {{~inject 'storefrontApiToken' settings.storefront_api.token}}\r\n    {{~inject 'clientIpAddress' settings.client_ip_address}}\r\n    {{#if customer}}\r\n        {{~inject 'customerId' customer.id}}\r\n        {{~inject 'customerEmail' customer.email}}\r\n        {{#if customer.shipping_address}}\r\n            {{~inject \"customerCity\" customer.shipping_address.city}}\r\n            {{~inject \"customerState\" customer.shipping_address.state}}\r\n            {{~inject \"customerCountry\" customer.shipping_address.country}}\r\n        {{/if}}\r\n    {{/if}}\r\n   {{#comment}}\r\n    <script>\r\n        var theme_settings = {\r\n            show_fast_cart: {{theme_settings.show_fast_cart}},\r\n            linksPerCol: {{theme_settings.nav-links-per-col}},\r\n        };\r\n    </script>\r\n    {{/comment}}\r\n\t<script async defer crossorigin=\"anonymous\" src=\"https://connect.facebook.net/en_US/sdk.js\"></script>\r\n</head>\r\n<body>\r\n    {{#block \"page\"}}{{/block}}\r\n\t<script>window.__webpack_public_path__ = \"{{cdn 'assets/dist/'}}\";</script>\r\n\t<script>\r\n\t\t{{!-- Exported in app.js --}}\r\n\t\tfunction onThemeBundleMain() {\r\n\t\t\twindow.stencilBootstrap(\"{{page_type}}\", {{jsContext}}).load();\r\n\t\t}\r\n\t</script>\r\n    <script async defer src=\"{{cdn 'assets/dist/theme-bundle.main.js'}}\" onload=\"onThemeBundleMain()\"></script>\r\n   \r\n</body>\r\n</html>\r\n","pages/order-confirmation":"{{#partial \"head\"}}\r\n{{{ checkout.checkout_head }}}\r\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\r\n{{ getFontsCollection }}\r\n<script src=\"{{cdn 'assets/js/jquery-3.6.3.min.js'}}\"></script>\r\n<script src=\"https://cdn.attn.tv/csd/dtag.js\"></script>\r\n<script type=\"text/javascript\">\r\n    window.language = {{{langJson 'optimized_checkout'}}};\r\n</script>\r\n\r\n{{{head.scripts}}}\r\n\r\n{{/partial}}\r\n\r\n{{#partial \"page\"}}\r\n<header class=\"checkoutHeader optimizedCheckout-header\">\r\n    <div class=\"checkoutHeader-content\">\r\n        <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}</h1>\r\n        <h2 class=\"checkoutHeader-heading\">\r\n            <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\r\n                {{#if checkout.header_image}}\r\n                    <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"{{ checkout.header_image }}\"/>\r\n                {{ else }}\r\n                    <span class=\"header-logo-text\">{{settings.store_logo.title}}</span>\r\n                {{/if}}\r\n            </a>\r\n        </h2>\r\n    </div>\r\n</header>\r\n\r\n{{{ checkout.order_confirmation_content }}}\r\n\r\n{{{ footer.scripts }}}\r\n\r\n{{/partial}}\r\n\r\n{{> layout/empty}}\r\n\r\n<script>\r\n\r\n    $(document).ready(function(){\r\n        fetch('/api/storefront/order/{{checkout.order.id}}', {credentials: 'include'})\r\n                .then((res) => res.json()).then(function (res) {\r\n                console.log(\"res\", res);\r\n               \r\n              var coupon = ''; \r\n            if(res.coupons.length > 0){\r\n                coupon = res.coupons[0].code;\r\n            };\r\n            var product_array = [];\r\n            let response = res.lineItems.physicalItems;\r\n            response.forEach(element => {\r\n            \r\n                    var obj =  {\r\n                                productId: element.productId,\r\n                                productVariantId: element.variantId,\r\n                                name: element.name,\r\n                                productImage: element.imageUrl,\r\n                                price: {\r\n                                  value: element.salePrice,\r\n                                  currency: '{{currency_selector.active_currency_code}}',\r\n                                },\r\n                                quantity: element.quantity\r\n                            };\r\n                            \r\n             product_array.push(obj);\r\n            });\r\n            \r\n           window.attentive.analytics.purchase(\r\n                    {\r\n                        items: product_array,\r\n                        cart: {\r\n                            cartId: res.cartId,\r\n                            cartCoupon: coupon\r\n                        },\r\n                        order: {\r\n                            orderId: res.orderId\r\n                        },\r\n                        user: {\r\n                            phone: res.billingAddress.phone\r\n                        }\r\n                    }\r\n                );\r\n        \r\n        //BODL events\r\n    \r\n        window.dataLayer = window.dataLayer || [];\r\n           \r\n        // If window.bodlEvents.checkout.orderPurchased is available, then...\r\n          if (typeof window.bodlEvents.checkout.orderPurchased === 'function') {\r\n              \r\n              window.dataLayer = window.dataLayer || [];\r\n            // run the orderPurchase function to get the payload\r\n            window.bodlEvents.checkout.orderPurchased((payload) => {\r\n              // log the event payload\r\n              \r\n              var bodl_data = {\r\n                  'event': 'bodl_v1_order_purchased'\r\n              }\r\n              \r\n              console.log(\r\n                'window.bodlEvents.checkout.orderPurchased ~ payload',\r\n                payload\r\n              );\r\n              \r\n                bodl_data.bodl_ecommerce = payload;\r\n          \r\n                window.dataLayer.push(bodl_data);\r\n                console.log(\"dataLayer\", dataLayer);\r\n            });\r\n          }\r\n        });\r\n        \r\n    });\r\n    \r\n</script>\r\n"}
