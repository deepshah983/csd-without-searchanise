<article class="card {{#if alternate}}card--alternate{{/if}}{{#if quick_search}} card-quick-result{{/if}}{{#or price.non_sale_price_with_tax price.non_sale_price_without_tax}} has-sale-price{{/or}}" {{#if settings.data_tag_enabled}} data-event-type="{{event}}" data-entity-id="{{id}}" data-position="{{position}}" data-name="{{name}}" data-product-category="{{#each category}}{{#if @last}}{{this}}{{else}}{{this}}, {{/if}}{{/each}}" data-product-brand="{{brand.name}}" data-product-price="{{#if price.with_tax}}{{price.with_tax.value}}{{else}}{{price.without_tax.value}}{{/if}}" data-product-currency="{{#if price.with_tax}}{{price.with_tax.currency}}{{else}}{{price.without_tax.currency}}{{/if}}"  {{/if}}>
	<figure class="card-figure">
{{!-- 
        {{#or price.sale_price_with_tax.value price.sale_price_without_tax.value}}
            {{#if theme_settings.show_sale_badges}}
                {{#unless quick_search}}
                    <div class="sale-flag-side">
                        <span class="sale-text">Sale</span>
                    </div>
                {{/unless}}
            {{/if}}
        {{/or}}
--}}
        {{#unless can_purchase}}
            <div class="stock-badge">
                <span class="stock-message">SOLD</span>
            </div>
		{{/unless}}
        <a href="{{url}}" {{#if theme_settings.show_alt_img_hover}}{{#gte images.length 2}}class="card-alt-img--hover card-image-normal"{{/gte}}{{/if}} {{#if settings.data_tag_enabled}} data-event-type="product-click" {{/if}}>
            {{#if can_purchase}}
			<div class="card-img-container">
			{{else}}
			<div class="card-img-container" style="opacity: 0.5">
			{{/if}}
                <span class="card-main-image">
                    <img class="card-image lazyload" data-sizes="auto" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN8/R8AAtsB7JKxzdUAAAAASUVORK5CYII=" data-src="{{getImage main_image 'productgallery_size' (cdn theme_settings.default_image_product)}}" alt="{{main_image.alt}}" title="{{main_image.alt}}">
                </span>
                {{#unless quick_search}}
                    {{#if theme_settings.show_alt_img_hover}}
                        {{#each (limit images 2)}}
                            {{#unless this.data '===' ../../image.data}}
                                <span class="card-alt-image">
                                    <img class="card-image lazyload" data-sizes="auto" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN8/R8AAtsB7JKxzdUAAAAASUVORK5CYII=" data-src="{{getImage this 'productgallery_size' (cdn theme_settings.default_image_product)}}" alt="{{image.alt}}" title="{{image.alt}}">
{{!-- 
                                    {{> components/common/responsive-img
                                        image=this
                                        class="card-image"
                                        fallback_size=theme_settings.productgallery_size
                                        lazyload=theme_settings.lazyload_mode
                                        default_image=theme_settings.default_image_product
                                    }}
--}}
                                </span>
                            {{/unless}}
                        {{/each}}
                    {{/if}}
                {{/unless}}
            </div>
        </a>
        {{#unless quick_search}}
            {{#or theme_settings.show_product_quick_view show_cart_action}}
	            {{#if can_purchase}}
				<figcaption class="card-figcaption">
				{{else}}
				<figcaption class="card-figcaption" style="opacity: 0.5">
				{{/if}}
                    <div class="card-figcaption-body">
                        <div class="card-figcaption--action-buttons">
                        {{#unless hide_product_quick_view}}
                            {{#if theme_settings.show_product_quick_view}}
                                {{#if settings.data_tag_enabled}}
                                    <a href="javascript:;" class="button button--secondary button--small card-figcaption-button quickview" data-event-type="product-click" data-product-id="{{id}}">{{lang 'products.quick_view'}}</a>
                                {{else}}
                                    <a href="javascript:;" class="button button--secondary button--small card-figcaption-button quickview" data-product-id="{{id}}">{{lang 'products.quick_view'}}</a>
                                {{/if}}
                            {{/if}}
                        {{/unless}}
                        {{#or customer (if theme_settings.restrict_to_login '!==' true)}}
                            {{#if show_cart_action}}
                                {{#if has_options}}
                                    <a href="{{url}}" data-event-type="product-click" class="button button--primary button--small card-figcaption-button" data-product-id="{{id}}">{{lang 'products.choose_options'}}</a>
                                {{/if}}
                                {{#if pre_order}}
                                    <a href="{{pre_order_add_to_cart_url}}" data-event-type="product-click" class="button button--primary button--small card-figcaption-button">{{lang 'products.pre_order'}}</a>
                                {{/if}}
                                {{#if can_purchase }}
                                    <a href="/cart.php?action=add&product_id={{id}}" data-event-type="product-click" class="button button--primary button--small card-figcaption-button button-card-add-to-cart">{{lang 'products.add_to_cart'}}</a>
                                {{/if}}
                                {{#if out_of_stock_message }}
                                    <a href="{{url}}" data-event-type="product-click" class="button button--small card-figcaption-button" data-product-id="{{id}}">{{out_of_stock_message}}</a>
                                {{/if}}
                            {{/if}}
                        {{/or}}
                        </div>
                    </div>
                </figcaption>
            {{/or}}
        {{/unless}}

            {{> components/csd/products/wishlist }}

            
{{!-- 
		<span class="product-wishlist" data-productid="{{id}}">
		    <a aria-controls="wishlist-dropdown-{{id}}"
		       aria-expanded="false"
		       class="dropdown-menu-button"
		       data-dropdown="wishlist-dropdown-{{id}}"
		       href="#"
		    >
				<i class="icon" aria-hidden="true">
                    <svg class="wishlist-solid" aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 477.534 477.534" xml:space="preserve"><path fill="currentColor" d="M438.482,58.61c-24.7-26.549-59.311-41.655-95.573-41.711c-36.291,0.042-70.938,15.14-95.676,41.694l-8.431,8.909
                                l-8.431-8.909C181.284,5.762,98.663,2.728,45.832,51.815c-2.341,2.176-4.602,4.436-6.778,6.778
                                c-52.072,56.166-52.072,142.968,0,199.134l187.358,197.581c6.482,6.843,17.284,7.136,24.127,0.654
                                c0.224-0.212,0.442-0.43,0.654-0.654l187.29-197.581C490.551,201.567,490.551,114.77,438.482,58.61z"/></svg>

                    <svg class="wishlist-outline" aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 477.534 477.534" xml:space="preserve"><path d="M438.482,58.61c-24.7-26.549-59.311-41.655-95.573-41.711c-36.291,0.042-70.938,15.14-95.676,41.694l-8.431,8.909
                                l-8.431-8.909C181.284,5.762,98.662,2.728,45.832,51.815c-2.341,2.176-4.602,4.436-6.778,6.778
                                c-52.072,56.166-52.072,142.968,0,199.134l187.358,197.581c6.482,6.843,17.284,7.136,24.127,0.654
                                c0.224-0.212,0.442-0.43,0.654-0.654l187.29-197.581C490.551,201.567,490.551,114.77,438.482,58.61z M413.787,234.226h-0.017
                                L238.802,418.768L63.818,234.226c-39.78-42.916-39.78-109.233,0-152.149c36.125-39.154,97.152-41.609,136.306-5.484
                                c1.901,1.754,3.73,3.583,5.484,5.484l20.804,21.948c6.856,6.812,17.925,6.812,24.781,0l20.804-21.931
                                c36.125-39.154,97.152-41.609,136.306-5.484c1.901,1.754,3.73,3.583,5.484,5.484C453.913,125.078,454.207,191.516,413.787,234.226
                                z"/></svg>
	            </i>
		    </a>
			<ul aria-hidden="true" class="dropdown-menu" data-dropdown-content id="wishlist-dropdown-{{id}}">
			{{#if customer.wishlists}}
	            {{#each customer.wishlists}}
				<li>
					<form action="{{this.add_url}}&product_id={{../id}}" class="form" method="post">
				    	<input type="submit" class="button button--primary button--small" value="{{this.name}}">
				    </form>
				</li>
	            {{/each}}
			{{/if}}
	        	<li>
	            	<a data-wishlist class="button" href="/wishlist.php?action=addwishlist&product_id={{id}}">{{lang 'account.wishlists.create_new'}}</a>
	        	</li>
			</ul>
		</span>
--}}
    </figure>
    {{#if can_purchase}}
	<div class="card-body">
	{{else}}
	<div class="card-body" style="opacity: 0.5">
	{{/if}}
        <div>
			<a class="card-link" href="{{url}}" {{#if settings.data_tag_enabled}} data-event-type="product-click" {{/if}}>
            {{#if theme_settings.card-show-brand}}
                {{#unless quick_search}}
                    {{#if brand.name}}
                        <p class="card-text brand-name" data-test-info-type="brandName">{{brand.name}}</p>
                    {{/if}}
                {{/unless}}
            {{/if}}
            <h4 class="card-title">{{title}}</h4>
            {{#comment}}
			<div class="card-fields">
                {{> components/csd/products/sizes-list custom_fields=custom_fields}}
			</div>
            {{/comment}}
{{!--
            <div class="card-fields">
                {{#each custom_fields}}{{#if name "==" "Colour"}}{{name}} {{value}}{{/if}}{{/each}}
            </div>
--}}
            <div class="card-text" data-test-info-type="price">
                {{#or customer (if theme_settings.restrict_to_login '!==' true)}}
                    {{> components/products/price price=price}}
                {{else}}
                    {{> components/common/login-for-pricing}}
                {{/or}}
            </div>
            {{#if quick_search}}
                {{#is stock_level 0}}
                    {{#unless out_of_stock_message}}
                        <span class="stock-message">Out of stock</span>
                    {{/unless}}
                {{/is}}
            {{/if}}
			</a>
        </div>

        <div class="card-details">
            {{#if show_compare}}
            <div class="card-compare-wrap">
                <label class="card-compare" for="compare-{{id}}">
                    <input type="checkbox" class="compare-input" name="products[]" value="{{id}}" id="compare-{{id}}" data-compare-id="{{id}}"><span>{{lang 'products.compare'}}</span>
                </label>
                <span class="compare-button-wrap">
                    <a class="compare-button" href="{{urls.compare}}" data-compare-nav>Compare <span class="countPill countPill--positive countPill--alt"></span> Items</a>
                </span>
            </div>
            {{/if}}
            
            {{#and rating show_rating}}
                <p class="card-text" data-test-info-type="productRating">
                    <span class="rating--small">
                        {{> components/products/ratings rating=rating}}
                    </span>
                </p>
            {{/and}}
            
            {{> components/products/bulk-discount-rates}}
        </div>
    </div>
</article>
